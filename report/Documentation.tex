
%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[paper=a4, fontsize=11pt]{scrartcl} % A4 paper and 11pt font size

\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs
\usepackage{fourier} % Use the Adobe Utopia font for the document - comment this line to return to the LaTeX default
\usepackage[english]{babel} % English language/hyphenation
\usepackage{amsmath,amsfonts,amsthm} % Math packages

\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template

\usepackage[utf8]{inputenc}

\usepackage{sectsty} % Allows customizing section commands
\allsectionsfont{\centering \normalfont\scshape} % Make all sections centered, the default font and small caps

\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage[]{algorithm2e}

\newtheorem{lemma}[theorem]{Lemma}

\usepackage{fancyhdr} % Custom headers and footers
\pagestyle{fancyplain} % Makes all pages in the document conform to the custom headers and footers
\fancyhead{} % No page header - if you want one, create it in the same way as the footers below
\fancyfoot[L]{} % Empty left footer
\fancyfoot[C]{} % Empty center footer
\fancyfoot[R]{\thepage} % Page numbering for right footer
\renewcommand{\headrulewidth}{0pt} % Remove header underlines
\renewcommand{\footrulewidth}{0pt} % Remove footer underlines
\setlength{\headheight}{13.6pt} % Customize the height of the header

\numberwithin{equation}{section} % Number equations within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{figure}{section} % Number figures within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{table}{section} % Number tables within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)

\setlength\parindent{0pt} % Removes all indentation from paragraphs - comment this line for an assignment with lots of text


%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command with 1 argument of height

\title{	
\normalfont \normalsize 
\textsc{University of Zagreb, Faculty of Electronics and Computing} \\ [25pt] % Your university, school and/or department name(s)
\horrule{0.5pt} \\[0.4cm] % Thin top horizontal rule
\huge Computing optimal tresholds for q-gram filters \\ % The assignment title
\horrule{2pt} \\[0.5cm] % Thick bottom horizontal rule
}

\author{Stipe Kuman, Dino RadakoviÄ‡, Leon Rotim} % Your name

\date{\normalsize\today} % Today's date or a custom date

\begin{document}

\maketitle % Print the title

%----------------------------------------------------------------------------------------
%	PROBLEM 1
%----------------------------------------------------------------------------------------

\section{Introduction into the problem}

In this project we have analyzed and recreated a paper on the topic of finding optimal thresholds for q-gram filters. Q-gram filters
are used for matching substrings of length \textit{q} in a text with substrings in a given pattern. In addition, the paper we are recreating
uses gapped q-grams, which allow for discontinuous text substrings. Gapped q-grams were shown to be more efficient than 
contiguous q-grams in the right conditions. However, computing an optimal threshold for those filters is also more difficult. 
Our project was done in C++ and can run on the bio-linux platform.
In the next section we will describe the process we used in our computation. Before that, we will describe some of the main
principles our algorithm is based on.  % Introduction text


%------------------------------------------------

\subsection{Problem description}

First off, we will describe the notation used in this assignment. \textit{T} is the text file, \textit{P} is the given pattern and \textit{S} stands 
for all the substrings in \textit{T} that match the given pattern \textit{P} within a Hamming distance of \textit{k} (number of non-matching characters). 
The length of the q-gram filter is \textit{q} and the threshold is represented by \textit{t}. Finally, \textit{m} is the length of \textit{P} and \textit{S}. \\
The goal of the q-gram filter is to reduce the number of potential matches that need to be compared to the given pattern \textit{P}. 
The threshold variable \textit{t} defines the minimum number of q-gram matches between the pattern \textit{P} and 
a substring so that the substring would be considered as a potential match. A low value of \textit{t} will result in too many potential matches, 
while a too high value may overlook some potential matches which would make the filter lossy. Only filters that label all the matches as 
potential matches will be considered in the assignment.\\
As stated previously, this assignment will focus on gapped q-grams. For contiguous q-grams an optimal threshold can be computed with a
simple mathematical formula, which is not true for gapped q-gram filters. In gapped q-gram filters the problem is much more complex
because a closed form formula has not been found. Because of that we have used the dynamic algorithm found in the assignment paper.



%----------------------------------------------------------------------------------------

\subsection{Pruning method}

Even with this reasnobly fast dinamic programming algorithm computing all possible gapped Q-grams with positive threshold for parameters $m=50,\ k=\{4,5\}$ is still a challenging task. Using brute force method, calculating threchold for all shapes in that have $m=50$ and $k=\{4,5\}$ and leaving only those for which positive threshold is computed, would leave us with search space of $2^{50}$ thresholds to compute. Since that kind of search space is clearly unfeasable we use fallowing lemma as
stated in~\cite{njihovPaper}. 

%does not work for whatever reason??
\begin{lemma}
    \label{subSetLemma}
    If $Q' \subseteq Q$ then $t_{Q'}(m,k)$ \geq $t_{Q}(m,k)$
\end{lemma}

Using lemma~\ref{subSetLemma} we propose simple pruning technique which we used while computing Q-shapes with positive thresholds.
Say that we have a set $Set_{current}$ which contains all Q-grams with size $q$, and we know values of thresholds for each Q-gram in the set. Next we define two empty sets, $Set_{next}$ and $Set_{forbbiden}$, which will contain Q-grams of size $q+1$. Now for each Q-gram, $Q_{i}$ in $Set_{current}$ run the following recurrence.

%I have no idea how to write this properly
% \begin{algorithm}
% \begin{algorithmic}
    % \For{each Q-gram $Q_{i} \in Set_{current}$}
    %     \State \For{ $i$ \in $\{2,\dots,m}$ }
    %         \State $Q_{i}' = Q_{i} \cup i$
    %         \State \IF{ threshold($Q_i$) &=&  0 }
    %                 \State $Set_{next} = Set_{next} \setminus Q_{i}'$
    %                 \State $Set_{forbbiden} = Set_{forbbiden} \cup Q_{i}'$
    %                \ELSIF { $Q_{i}' \notin $Set_{forbbiden}$ }
    %                 \State $Set_{next} = Set_{next} \cup Q_{i}'$
    %                \ENDIF
    %     \EndFor
    % \EndFor
% \end{algorithmic}
% \end{algorithm}

Using this simple pruning method we\dots


%----------------------------------------------------------------------------------------


\end{document}
